<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/noe-ricoy/noe-ricoy.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/login-workshop/login-workshop.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="workshop-app">
  <template>
    <style>
      :host {
        display: block;
      }

      .icon {
        cursor: pointer;
        padding-top: 2px;
      }

      .ricoy {
        margin-bottom: 20px;
      }

      .container {
        margin-top: 55px;
        display: grid;
        grid-template-columns: repeat(4, 1fr);
      }

      .inputBinding {
        width: 50%;
      }

      paper-card {
        margin: 1em;
      }

      .myStyleOne {
        --noe-ricoy-text-style: {
          color: green;
        }

        --noe-ricoy-text-translate-Y: {
          transform: translateY(-3em);
        }

        --noe-ricoy-text-translate-X: {
          transform: translateX(1em);
        }
      }

      .myStyleTwo {
        --noe-ricoy-text-style: {
          font-size: 120px;
          background-color: rgb(43, 43, 43);
          color: red;
          border-radius: 10px;
        }
      }

      .myStyleThree {
        --noe-ricoy-text-style: {
          color: blue;
        }

        --noe-ricoy-text-translate-Y: {
          transform: skewX(30deg);
        }

        --noe-ricoy-text-translate-X: {
          transform: translateX(0.1em);
        }
      }
    </style>

    <template is="dom-if" if="[[!success]]">
      <!--<login-workshop on-signin-changed="hiddenLogin"></login-workshop>-->
      <login-workshop></login-workshop>
    </template>

    <template is="dom-if" if="[[success]]">
      <paper-card> <div class="card-content">
        <p>Hacer click sobre el texto para animación</p>
      </div></paper-card>

      <div class="form">
        <div class="inputBinding">
          <paper-input always-float-label label="Floating label" id="inputText"></paper-input>
          <paper-button on-click="changeText" toggles raised class="indigo">
            Agregar
          </paper-button>
        </div>
      </div>
      
      <div class="container" id="nooContent">
        <paper-card><div class="card-content">
            <noe-ricoy class="myStyleOne" text="[[ text ]]" class="ricoy"></noe-ricoy>
        </div></paper-card>
  
        <paper-card> <div class="card-content">
            <noe-ricoy text="°°°°°" class="ricoy"></noe-ricoy>
        </div></paper-card>
  
        <paper-card> <div class="card-content">
          <noe-ricoy class="myStyleTwo" text="°°°°°" class="ricoy"></noe-ricoy>
        </div></paper-card>
  
        <paper-card><div class="card-content">
          <noe-ricoy class="myStyleThree" text="[[ text ]]" class="ricoy"></noe-ricoy>
          </div></paper-card>
        </div>
    
        <div class="inputBinding">
          <paper-input always-float-label label="Floating label" id="inputTextKeyUp" on-keyup="changeTextKeyUp" value="[[ text ]]"></paper-input>
        </div>
    </template>

    <!--<template is="dom-if" if="[[success]]"> -->
      <iron-ajax
        auto
        url="https://pokeapi.co/api/v2/pokemon?limit=50"
        handle-as="json"
        on-response="getPokemonsName"
      >
      </iron-ajax>

      <template is="dom-repeat" items="[[ PokemonsName ]]">
        <paper-card><div class="card-content">
          <p>{{ item.name }}</p>
          <img src="{{ item.url }}" alt="">
          </div></paper-card>
        </div>
      </template>
    </template>
  <!-- </template> -->

  <script>
    /**
     * @customElement
     * @polymer
     */
    class WorkshopApp extends Polymer.Element {
      static get is() { return 'workshop-app'; }
      static get properties() {
        return {
          success: {
            type: Boolean,
            value: true,
          },
          PokemonsName: {
            type: Array,
            value() {return []}
          }
        };
      }

      ready() {
        super.ready();
        this.addEventListener('SigIn', (e) => {
          this.success = e.detail.signin;
        });
      }

      getPokemonsName(e) {
        let data = e.detail.response['results'];
        let pokes = [];

        data.forEach((pokemon, id) => {
          pokes.push({
            name: pokemon.name,
            url: `https://pokeres.bastionbot.org/images/pokemon/${id+1}.png`
          });
        });

        this.PokemonsName = pokes;
      }

      getPokemonsImage(e) {
        console.log(e.detail.response)
      }

      changeText() {
        this.text = this.$.inputText.value;
        let nooContent = this.$.nooContent;
        
        let noeRicoy = document.createElement('noe-ricoy');
        let card = document.createElement('paper-card');

        if(this.text)
            noeRicoy.setAttribute('text', `${ this.text }`);

        card.appendChild(noeRicoy); 
        nooContent.appendChild(card);
      }

      changeTextKeyUp() {
        this.text = this.$.inputTextKeyUp.value;
      }

      hiddenLogin() {
       this.success = true;
      }
    }

    window.customElements.define(WorkshopApp.is, WorkshopApp);
  </script>
</dom-module>